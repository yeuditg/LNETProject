<div class="create-container">
  <div class="create-card">
    <div class="card-header">
      <h2 class="title">צור שאלה חדשה</h2>
      <p class="subtitle">הוסף שאלה ותשובות אפשריות להצבעה</p>
    </div>

    <div class="form-section">
      <div class="input-group">
        <label class="input-label">השאלה שלך</label>
        <input
          type="text"
          [(ngModel)]="currentQuestion.Text"
          name="questionText"
          placeholder="לדוגמה: מה הפיצה האהובה עליכם?"
          class="question-input"
        >
      </div>

      <div class="input-group">
        <label class="input-label">סוג השאלה</label>
        <div class="type-options">
          <label>
            <input type="radio" name="qtype" [(ngModel)]="currentQuestion.Type" [value]="QuestionType.Poll"> POLL
          </label>
        <br/>
          <label>
            <input type="radio" name="qtype" [(ngModel)]="currentQuestion.Type" [value]="QuestionType.Trivia"> TRIVIA
          </label>
        </div>
        @if(currentQuestion.Type === QuestionType.Poll){
          <small>POLL — אין לבחור תשובה נכונה</small>
        }
        @if(currentQuestion.Type === QuestionType.Trivia){
          <small>TRIVIA — יש לבחור תשובה נכונה אחת</small>
        }
      </div>

      <div class="answers-section">
        <div class="section-header">
          <label class="input-label">תשובות אפשריות</label>
          <span class="answers-count">{{ currentQuestion.Answers.length }} תשובות</span>
        </div>

        <div class="answers-list">
          @for(answer of currentQuestion.Answers; track trackByIndex($index); let i = $index){
            <div class="answer-item">
              <div class="answer-tag">{{ i + 1 }}</div>

              <input
                type="text"
                [(ngModel)]="currentQuestion.Answers[i].text"
                [name]="'answer-' + i"
                placeholder="תשובה {{ i + 1 }}"
                class="answer-input"
              >

             
              @if(currentQuestion.Type === QuestionType.Trivia){
                <div class="correct-marker">
                  <input
                    [attr.type]="allowMultipleCorrect ? 'checkbox' : 'radio'"
                    [checked]="currentQuestion.Answers[i].isCorrect"
                    (change)="onCorrectToggle($event, i)"
                    [attr.name]="allowMultipleCorrect ? null : 'correct-group'"
                    [attr.title]="allowMultipleCorrect ? 'סמן כתשובה נכונה (מספר אפשרויות אפשרי)' : 'סמן כתשובה נכונה (אפשרות יחידה)'"
                  >
                  <label>תשובה נכונה</label>
                </div>
              }

              @if(currentQuestion.Answers.length > 2){
                <button
                  (click)="removeAnswer(i)"
                  class="remove-btn"
                  type="button"
                  title="מחק תשובה"
                >
                  מחק
                </button>
              }
            </div>
          }
        </div>

        @if(currentQuestion.Answers.length < 5){
          <button 
            (click)="addAnswer()" 
            type="button" 
            class="add-answer-btn"
          >
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            הוסף תשובה נוספת
          </button>
        }
      </div>

      <button (click)="createQuestion()" type="button" class="submit-btn">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        צור שאלה
      </button>
    </div>
  </div>
</div>
